@model IEnumerable<TechShop.Models.Post>
@{
    ViewBag.Title = "Bài viết";
    int currentPage = ViewBag.CurrentPage;
    int totalPages = ViewBag.TotalPages;
}

<h2 class="mt-3 mb-4">Danh sách bài viết</h2>

<div class="row">
    @foreach (var post in Model)
    {
        <div class="col-md-4 mb-4">
            <div class="card shadow-sm">

                <!-- Thumbnail -->
                <img src="@post.ThumbnailURL" class="card-img-top" style="height:200px; object-fit:cover" />

                <div class="card-body">
                    <h5 class="card-title">@post.Title</h5>

                    <p class="text-muted">
                        <i class="fa fa-calendar"></i>
                        @post.PublishedDate?.ToString("dd/MM/yyyy")
                    </p>

                    <p class="card-text" style="height: 60px; overflow: hidden;">
                        @(post.Content != null ?
                              Html.Raw(post.Content.Length > 80 ? post.Content.Substring(0, 80) + "..." : post.Content)
                              : "Không có nội dung.")
                    </p>

                    <a href="@Url.Action("Detail", "Posts", new { id = post.PostID })"
                       class="btn btn-primary btn-sm">
                        Đọc tiếp
                    </a>
                </div>

            </div>
        </div>
    }
</div>

<!-- PAGINATION -->
@if (totalPages > 1)
{
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center mt-4">

            <!-- Prev -->
            <li class="page-item @(currentPage == 1 ? "disabled" : "")">
                <a class="page-link" href="@Url.Action("Index", new { page = currentPage - 1 })">‹</a>
            </li>

            <!-- Page Numbers -->
            @for (int i = 1; i <= totalPages; i++)
            {
                <li class="page-item @(i == currentPage ? "active" : "")">
                    <a class="page-link" href="@Url.Action("Index", new { page = i })">@i</a>
                </li>
            }

            <!-- Next -->
            <li class="page-item @(currentPage == totalPages ? "disabled" : "")">
                <a class="page-link" href="@Url.Action("Index", new { page = currentPage + 1 })">›</a>
            </li>

        </ul>
    </nav>
}
